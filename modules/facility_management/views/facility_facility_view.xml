<?xml version='1.0' encoding='utf-8'?>

<odoo noupdate="0">

  <!-- VIEWS: "Facilities"

        - Model·········: facility
        - _rec_name·····: name
        - Domain········: []
        - Context·······: {}
        - Parent menu ··: facility_management.menu_facilities
        - View priority·: 16    Sequence····: 10
        - Action help···: There are no facilities yet
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

  <!-- List view for "facility.facility" -->
  <record id="view_facility_tree" model="ir.ui.view">
    <field name="name">view.facility.tree</field>
    <field name="model">facility.facility</field>
    <field name="type">list</field>
    <field name="priority" eval="16"/>
    <field name="active" eval="True"/>
    <field name="arch" type="xml">
      <list string="facility_tree" decoration-success="color == 10" decoration-danger="color == 1"
        decoration-warning="color == 3">
        <field name="color" class="oe_field_color" column_invisible="1"/>
        <field name="code" class="oe_field_code" optional="hide" />
        <field name="display_name" class="oe_field_display_name"/>
        <field name="complex_id" class="oe_field_complex_id" optional="show" />
        <field name="type_id" class="oe_field_type_id" optional="show" />
        <field name="is_space" class="oe_field_is_space" optional="hide" />
        <field name="users_str" class="oe_field_users_str" string="Seats" optional="show" />
        <field name="next_use" class="oe_field_next_use" optional="show" />
      </list>
    </field>
  </record>

  <!-- Form view for "facility.facility" -->
  <record id="view_facility_form" model="ir.ui.view">
    <field name="name">view.facility.form</field>
    <field name="model">facility.facility</field>
    <field name="type">form</field>
    <field name="priority" eval="16"/>
    <field name="active" eval="True"/>
    <field name="arch" type="xml">
      <form string="facility_form">
        <sheet>
          <div class="oe_button_box" name="button_box">
            <button name="view_reservations" type="object" class="oe_stat_button oe_read_only"
              icon="fa-calendar" help="Show related reservations">
              <field name="reservation_count" widget="statinfo" string="Reservations"/>
            </button>
          </div>

          <widget name="web_ribbon" title="Archived" bg_color="bg-danger" invisible="active"/>

          <field name="image_1920" widget="image" class="oe_avatar"
            options="{'preview_image': 'image_128'}"/>

          <div class="oe_title">
            <field name="id" class="oe_field_id" invisible="1"/>
            <field name="active" invisible="1"/>

            <label for="name" class="oe_edit_only"/>
            <h1>
              <field name="name" class="oe_field_name" placeholder="Enter new name"/>
            </h1>

            <group>
              <field name="complex_id" class="oe_field_company_id"/>
              <field name="code" class="oe_field_code"/>
            </group>

          </div>

          <group col="2">
            <group col="2" string="Type">
              <field name="type_id" class="oe_field_type_id"/>
              <field name="is_space" class="oe_field_is_space"/>
            </group>
            <group col="2" string="Capacity">
              <field name="users" class="oe_field_users"/>
              <field name="excess" class="oe_field_excess"/>
            </group>
          </group>

          <notebook>
            <page string="Description" class="oe_page_description" accesskey="D">
              <group col="2">
                <field name="description" class="oe_field_description"
                  placeholder="Enter new description" colspan="4" nolabel="1"/>
              </group>
            </page>
            <page id="setup" string="Setup" class="oe_page_setup" accesskey="S">
              <group col="4" string="Ownership" groups="record_ownership.record_ownership_proxy">
                <field name="owner_id" class="oe_field_owner_id"/>
                <field name="subrogate_id" class="oe_field_subrogate_id"/>
              </group>
            </page>
          </notebook>
        </sheet>

        <chatter/>

      </form>
    </field>
  </record>

  <record id="view_facility_kanban" model="ir.ui.view">
    <field name="name">view.facility.kanban</field>
    <field name="model">facility.facility</field>
    <field name="type">kanban</field>
    <field name="priority" eval="16"/>
    <field name="active" eval="True"/>
    <field name="arch" type="xml">
      <kanban highlight_color="color">
        <templates>
          <t t-name="card" class="flex-row">
            <widget name="web_ribbon" title="Archived" bg_color="text-bg-danger" invisible="active"/>

            <aside class="o_kanban_aside_full">
              <t t-if="record.image_128.raw_value">
                <field name="image_128" class="w-100" widget="image"
                  options="{'img_class': 'w-100 h-auto p-2 align-top'}"/>
              </t>
              <t t-if="!record.image_128.raw_value">
                <img src="/facility_management/static/src/img/facility-facility-128.png" class="w-100 h-auto p-2"
                  alt="Facility" title="Facility without image" />
              </t>
            </aside>

            <div class="flex-fill d-flex flex-column justify-content-between overflow-hidden w-100 ps-2 ps-md-0">
              <main class="d-flex flex-column justify-content-start align-items-start">
                <h2 class="h4">
                  <field name="display_name"/>
                </h2>

                <ul class="list-unstyled w-100 small">
                  <li class="d-flex flex-row justify-content-start lh-lg text-truncate" title="Facility complex">
                    <strong class="pe-2">Complex:</strong>
                    <field name="complex_id"/>
                  </li>

                  <li class="d-flex flex-row justify-content-start lh-lg text-truncate" title="Facility type">
                    <strong class="pe-2">Type:</strong>
                    <field name="type_id" class="oe_field_type_id"/>
                  </li>

                  <li class="d-flex flex-row justify-content-start lh-lg text-truncate" title="Next use">
                    <strong class="pe-2">Next use:</strong>
                    <field name="next_use" class="oe_field_next_use ml-3"/>
                  </li>

                  <li class="d-flex flex-row justify-content-start lh-lg text-truncate" title="Number of users">
                    <strong class="pe-2">Users:</strong>
                    <field name="users_str" class="oe_field_users_str"/>
                  </li>

                </ul>

              </main>

              <!-- footer: begin -->
              <footer class="d-flex justify-content-end align-items-start mt-2" />
              <!-- footer: end -->

            </div>

          </t>
        </templates>

      </kanban>
    </field>
  </record>

  <!-- Search view for "facility.facility" -->
  <record id="view_facility_search" model="ir.ui.view">
    <field name="name">view.facility.search</field>
    <field name="model">facility.facility</field>
    <field name="type">search</field>
    <field name="priority" eval="16"/>
    <field name="active" eval="True"/>
    <field name="arch" type="xml">
      <search string="facility_search">
        <field name="name" class="oe_field_name"/>
        <field name="type_id" class="oe_field_type_id"/>
        <field name="complex_id" class="oe_field_complex_id"/>
        <field name="users" class="oe_field_users"/>
        <field name="excess" class="oe_field_users"/>
        <field name="next_use" class="oe_field_next_use"/>

        <filter name="inactive" string="Archived" domain="[('active','=', False)]"/>

        <separator/>
        <filter name="rooms" string="Classrooms" domain="[('users', '&gt;', 0)]" help="Is a room"/>
        <filter name="equipment" string="Equipment" domain="[('users', '=', 0)]" help="Is equipment"/>

        <separator/>
        <filter string="Available" name="available"
          domain="[('is_available', '=', True)]"/>

        <group expand="0" name="group_by" string="Group By">
          <filter name="group_by_type_id" string="Facility type" domain="[]"
            context="{'group_by' : 'type_id'}"/>
          <filter name="group_by_complex_id" string="Complex" domain="[]"
            context="{'group_by' : 'complex_id'}"/>
        </group>
      </search>
    </field>
  </record>

  <!-- Main window action for model.name -->
  <record id="action_facilities_act_window" model="ir.actions.act_window">
    <field name="type">ir.actions.act_window</field>
    <field name="name">Facilities</field>
    <field name="res_model">facility.facility</field>
    <field name="view_mode">kanban,list,form</field>
    <field name="path">facility-facility</field>
    <field name="target">current</field>
    <field name="domain">[]</field>
    <field name="context">{}</field>
    <field name="search_view_id" ref="view_facility_search"/>
    <field name="help" type="html">
      <p class="oe_view_nocontent_create"> Click to add new facilities </p>
      <p> There are no facilities yet </p>
    </field>
  </record>

  <!-- Main menu for model.name -->
  <record id="menu_facilities" model="ir.ui.menu">
    <field name="name">Facilities</field>
    <field name="sequence" eval="15"/>
    <field name="action" ref="action_facilities_act_window"/>
    <field name="parent_id" ref="facility_management.menu_facility_management_facilities"/>
    <field name="groups_id" eval="[(4, ref('facility_management.facility_group_consultant'))]"/>
  </record>

</odoo>
